# ============================================================================
# EQUITY RESEARCH PLATFORM - ENVIRONMENT VARIABLES
# ============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control

# ============================================================================
# POSTGRESQL (Equity Research Database)
# ============================================================================
# Airflow metadata DB is configured in docker-compose.yml
# This is the separate equity_research database for agent data
POSTGRES_EQUITY_URL=postgresql://airflow:airflow@postgres:5432/equity_research

# ============================================================================
# NEO4J (Supply Chain Graph Database)
# ============================================================================
NEO4J_URI=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=neo4j_password

# ============================================================================
# QDRANT (Vector Database for RAG)
# ============================================================================
QDRANT_URL=http://qdrant:6333
QDRANT_API_KEY=  # Optional - leave empty for local dev

# ============================================================================
# DUCKDB (OLAP Time-Series Database)
# ============================================================================
# Paths inside Docker container
DUCKDB_QUANTITATIVE_PATH=/opt/airflow/duckdb_storage/quantitative.duckdb
DUCKDB_MACRO_PATH=/opt/airflow/duckdb_storage/macro.duckdb

# ============================================================================
# FINANCIAL DATA APIs
# ============================================================================

# EODHD - Required for:
# - SEC filings (10-K/10-Q)
# - EOD prices (30+ years)
# - Fundamentals (income statements, balance sheets, cash flows)
# - Macro indicators (GDP, unemployment, CPI)
# - Insider transactions (Form 4)
# Get your API key: https://eodhd.com/
EODHD_API_KEY=your_eodhd_api_key_here

# FMP - Required for:
# - Detailed financial statements (as-reported)
# - Earnings call transcripts
# - Press releases
# - Analyst upgrades/downgrades
# - 13F institutional holdings
# Get your API key: https://financialmodelingprep.com/
FMP_API_KEY=your_fmp_api_key_here

# ============================================================================
# WEB SEARCH APIs
# ============================================================================

# Tavily - Required for:
# - Real-time web search
# - Breaking news retrieval
# - HyDE-based semantic search
# Get your API key: https://tavily.com/
TAVILY_API_KEY=your_tavily_api_key_here

# Cohere - Optional for:
# - Reranking search results
# - Improved relevance scoring
# Get your API key: https://cohere.com/
COHERE_API_KEY=your_cohere_api_key_here

# ============================================================================
# LLM / EMBEDDING MODELS
# ============================================================================

# Ollama - Local LLM for:
# - Proposition chunking (Business Analyst)
# - NER extraction (Supply Chain Graph)
# - Sentiment analysis (Insider & Sentiment)
# Install: https://ollama.ai/
# For Mac/Windows Docker Desktop:
OLLAMA_BASE_URL=http://host.docker.internal:11434
# For Linux:
# OLLAMA_BASE_URL=http://172.17.0.1:11434

# OpenAI - Optional fallback for:
# - High-quality embeddings (text-embedding-3-small)
# - GPT-4 for complex reasoning
# Get your API key: https://platform.openai.com/
OPENAI_API_KEY=your_openai_api_key_here

# ============================================================================
# TICKER WATCHLIST
# ============================================================================
# Comma-separated list of tickers to analyze
# Start small for testing (5-10 tickers), expand for production
TICKER_WATCHLIST=AAPL,MSFT,GOOGL,AMZN,TSLA,NVDA,META,NFLX,JPM,V

# ============================================================================
# DAG SCHEDULING
# ============================================================================
# Enable/disable automatic DAG runs
ENABLE_DAILY_INGESTION=true

# Custom schedule overrides (leave empty to use default)
# Format: Cron expression (e.g., "0 6 * * *" for 6 AM daily)
DAG_01_SCHEDULE=  # Default: 0 6 * * * (6 AM HKT daily)
DAG_02_SCHEDULE=  # Default: 0 7 * * * (7 AM HKT daily)
DAG_03_SCHEDULE=  # Default: 0 8 * * * (8 AM HKT daily)
DAG_04_SCHEDULE=  # Default: 0 9 * * * (9 AM HKT daily)
DAG_05_SCHEDULE=  # Default: 0 10 * * * (10 AM HKT daily)
DAG_06_SCHEDULE=  # Default: 0 11 * * * (11 AM HKT daily)

# ============================================================================
# DEVELOPMENT / TESTING
# ============================================================================
# Set to "true" to enable test mode (smaller datasets, faster execution)
TEST_MODE=true

# Limit number of tickers processed in test mode
TEST_TICKER_LIMIT=5

# Limit historical data range in test mode (years)
TEST_YEARS_LOOKBACK=3

# ============================================================================
# LOGGING
# ============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Enable verbose API logging (for debugging API issues)
VERBOSE_API_LOGS=false

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================
# Maximum concurrent API requests (respect rate limits)
MAX_CONCURRENT_REQUESTS=5

# Request timeout (seconds)
REQUEST_TIMEOUT=30

# Retry attempts for failed API calls
MAX_RETRIES=3

# Backoff factor for retries (exponential: 1s, 2s, 4s, 8s...)
RETRY_BACKOFF_FACTOR=2

# ============================================================================
# SLACK NOTIFICATIONS (Optional)
# ============================================================================
# Webhook URL for Airflow alerts
SLACK_WEBHOOK_URL=

# Enable notifications for DAG failures
SLACK_NOTIFY_ON_FAILURE=true

# Enable notifications for DAG success
SLACK_NOTIFY_ON_SUCCESS=false
